const validator = require('validator');


const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
function randChar() {
	const index = Math.floor(Math.random() * possibleCharacters.length);
	return possibleCharacters[index];
}

const defaultLength = 10;

function generate(length = defaultLength) {
	length = (typeof(length) === 'number' && length > 0) ? length : defaultLength;
	let string = '';
	for (let i = 0; i < length; i++) string += randChar();
	return string;
}

function validate(id) {
	if (validator.validate(id).type('string').check(str => str.split('').every(chr => possibleCharacters.indexOf(chr) !== -1)).end())
		return id;
	return false;
}

module.exports = {
	generate,
	validate,
}
